"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isRouteModuleFile = exports.findParentRouteId = exports.byLongestFirst = exports.stripFileExtension = exports.createRouteId = void 0;
const utils_1 = require("@umijs/utils");
const path_1 = require("path");
function createRouteId(file) {
    return (0, utils_1.winPath)(stripFileExtension(file));
}
exports.createRouteId = createRouteId;
function stripFileExtension(file) {
    return file.replace(/\.[a-z0-9]+$/i, '');
}
exports.stripFileExtension = stripFileExtension;
function byLongestFirst(a, b) {
    return b.length - a.length;
}
exports.byLongestFirst = byLongestFirst;
function findParentRouteId(routeIds, childRouteId) {
    return routeIds.find((id) => childRouteId.startsWith(`${id}/`));
}
exports.findParentRouteId = findParentRouteId;
const routeModuleExts = ['.js', '.jsx', '.ts', '.tsx', '.md', '.mdx'];
function isRouteModuleFile(opts) {
    // TODO: add cache strategy
    for (const excludeRegExp of opts.exclude || []) {
        if (opts.file &&
            excludeRegExp instanceof RegExp &&
            excludeRegExp.test(opts.file)) {
            return false;
        }
    }
    return routeModuleExts.includes((0, path_1.extname)(opts.file));
}
exports.isRouteModuleFile = isRouteModuleFile;
